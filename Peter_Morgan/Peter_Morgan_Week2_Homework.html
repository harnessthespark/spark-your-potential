<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peter Morgan - Week 2 Homework | Spark Your Potential</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            padding: 40px 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .header h1 {
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .intro {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #22c55e;
            margin-bottom: 40px;
        }

        .intro h3 {
            color: #166534;
            margin-bottom: 10px;
        }

        .intro p {
            color: #15803d;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #7c3aed;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #7c3aed;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-card {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid #e2e8f0;
            transition: border-color 0.3s ease;
        }

        .question-card:focus-within {
            border-color: #7c3aed;
        }

        .question-card h4 {
            color: #1e293b;
            font-size: 1.1em;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .question-number {
            background: #7c3aed;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            flex-shrink: 0;
        }

        .question-card .hint {
            font-size: 0.9em;
            color: #64748b;
            font-style: italic;
            margin-bottom: 15px;
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #7c3aed;
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        textarea::placeholder {
            color: #94a3b8;
        }

        .homework-card {
            background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #eab308;
        }

        .homework-card h4 {
            color: #854d0e;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .homework-card p {
            color: #713f12;
            margin-bottom: 15px;
        }

        .save-indicator {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #22c55e;
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .save-indicator.visible {
            opacity: 1;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #7c3aed, #a855f7);
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            color: #64748b;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(124, 58, 237, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #7c3aed;
            border: 2px solid #7c3aed;
        }

        .btn-secondary:hover {
            background: #f5f3ff;
        }

        .context-box {
            background: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin-bottom: 20px;
        }

        .context-box h5 {
            color: #0369a1;
            margin-bottom: 8px;
        }

        .context-box p {
            color: #0c4a6e;
            font-size: 0.95em;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
            }
            .save-indicator, .action-buttons {
                display: none;
            }
            textarea {
                border: 1px solid #ccc;
                min-height: 80px;
            }
        }

        @media (max-width: 768px) {
            .content {
                padding: 25px;
            }
            .action-buttons {
                flex-direction: column;
            }
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="back-btn" onclick="goBackToPortal()">‚Üê Back to Portal</button>
            <h1>Week 2 Homework</h1>
            <div class="subtitle">Peter Morgan | Career Booster Programme</div>
        </div>

        <div class="content">
            <div class="intro">
                <h3>Great Session Today!</h3>
                <p>Take your time with these questions. There are no wrong answers - this is about getting clear on what matters to you. Your answers will shape our work in Session 3.</p>
            </div>

            <div class="progress-text">Progress: <span id="progressPercent">0</span>% complete</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <!-- KEY QUESTIONS SECTION -->
            <div class="section">
                <h2 class="section-title">Key Questions to Reflect On</h2>
                <p style="color: #64748b; margin-bottom: 25px;">These build on what we explored in session. Take your time - there's no rush.</p>

                <div class="question-card">
                    <h4>
                        <span class="question-number">1</span>
                        What does success look like for you in the next 12 months?
                    </h4>
                    <p class="hint">Think about career, personal growth, and life balance. What would make you feel proud?</p>
                    <textarea id="q1" placeholder="Write your thoughts here... Consider: What would success look like? How would you feel? What would be different?"></textarea>
                </div>

                <div class="question-card">
                    <h4>
                        <span class="question-number">2</span>
                        What environments have let you thrive vs. frustrated you?
                    </h4>
                    <p class="hint">Think about past roles, teams, and work settings - what made each work or not work?</p>
                    <textarea id="q2" placeholder="Write your thoughts here... What patterns do you notice? What conditions do you need to do your best work?"></textarea>
                </div>

                <div class="question-card">
                    <h4>
                        <span class="question-number">3</span>
                        If you could design your ideal role, what would you be doing day-to-day?
                    </h4>
                    <p class="hint">Not job title - actual activities. What does a great Monday look like?</p>
                    <textarea id="q3" placeholder="Write your thoughts here... Morning, afternoon, the kind of conversations you'd be having, the problems you'd be solving..."></textarea>
                </div>

                <div class="question-card">
                    <h4>
                        <span class="question-number">4</span>
                        What's the bigger impact you want to have through your work?
                    </h4>
                    <p class="hint">Your legacy. When people talk about your career, what do you want them to say?</p>
                    <textarea id="q4" placeholder="Write your thoughts here... This is the big one. What's the change you want to create?"></textarea>
                </div>
            </div>

            <!-- HOMEWORK TASKS SECTION -->
            <div class="section">
                <h2 class="section-title">Homework Tasks</h2>
                <p style="color: #64748b; margin-bottom: 25px;">Complete these before our next session.</p>

                <div class="homework-card">
                    <h4>1. Validate the Drains & Charges</h4>
                    <p>Review the "What Drains You / What Charges You" section in your Insights Report. Add, remove, or refine based on what feels true.</p>
                    <textarea id="hw1" placeholder="What drains you? What charges you? Add any that are missing, remove any that don't feel right..."></textarea>
                </div>

                <div class="homework-card">
                    <h4>2. List 3-5 Dream Companies or Opportunities</h4>
                    <p>Organisations or opportunities where your abilities would be valued. Don't filter - include the ambitious ones.</p>
                    <textarea id="hw2" placeholder="1.
2.
3.
4.
5.

Why these? What draws you to each?"></textarea>
                </div>

                <div class="homework-card">
                    <h4>3. The "Hell Yes" Criteria</h4>
                    <p>What would make an opportunity feel like an absolute yes? What are your non-negotiables?</p>
                    <textarea id="hw3" placeholder="The opportunity MUST have:
-
-
-

Deal-breakers (I will NOT accept):
-
- "></textarea>
                </div>

                <div class="homework-card">
                    <h4>4. Your Unique Value Proposition</h4>
                    <p>Based on what we discussed, how would you describe what makes you uniquely valuable? What problems do you solve that others struggle with?</p>
                    <textarea id="hw4" placeholder="I help organisations by...

The unique way I approach problems is...

People come to me when they need..."></textarea>
                </div>
            </div>

            <!-- CONTEXT REMINDER -->
            <div class="context-box">
                <h5>Remember</h5>
                <p>There are no wrong answers here. This is about exploring and getting clear on what matters most to you. Your responses will help shape our next conversation.</p>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="saveProgress()">Save Progress</button>
                <button class="btn btn-secondary" onclick="emailToLisa()">Email to Lisa</button>
                <button class="btn btn-secondary" onclick="downloadHomework()">Download</button>
                <button class="btn btn-secondary" onclick="window.print()">Print</button>
            </div>
        </div>

        <div style="text-align: center; padding: 30px; background: #f8f9fa; color: #7f8c8d; font-size: 0.9em;">
            <p>Career Booster Programme with Lisa Gills | Harness the Spark</p>
            <p style="margin-top: 5px;">Due before Session 3</p>
        </div>
    </div>

    <div class="save-indicator" id="saveIndicator">Progress Saved</div>

    <!-- PDF Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
        // Smart back navigation
        function goBackToPortal() {
            const savedUser = localStorage.getItem('syp_user');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    const access = user.programme_access || user.programme_type || 'career';
                    if (access === 'audhd') {
                        window.location.href = '../audhd-dashboard.html';
                    } else {
                        window.location.href = '../client-portal.html';
                    }
                    return;
                } catch(e) {}
            }
            window.location.href = '../client-portal.html';
        }

        // PostgreSQL API Configuration
        const API_BASE = 'https://potential.harnessthespark.com';
        const CLIENT_EMAIL = 'peter.morgan@example.com';
        const HOMEWORK_TYPE = 'week2';

        const textareas = document.querySelectorAll('textarea');
        let saveTimeout = null;

        // Load saved data on page load
        window.onload = function() {
            loadProgress();
            updateProgressBar();
        };

        // Auto-save on input with debounce
        textareas.forEach(textarea => {
            textarea.addEventListener('input', function() {
                updateProgressBar();
                // Debounce: save after 2 seconds of no typing
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(() => {
                    saveProgress(true); // silent save
                }, 2000);
            });
        });

        async function saveProgress(silent = false) {
            const data = {};
            textareas.forEach(textarea => {
                data[textarea.id] = textarea.value;
            });
            data.lastSaved = new Date().toISOString();
            data.progress = calculateProgress();

            // Save to PostgreSQL via API
            try {
                const response = await fetch(`${API_BASE}/api/homework`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        client_email: CLIENT_EMAIL,
                        homework_type: HOMEWORK_TYPE,
                        responses: data
                    })
                });

                if (response.ok) {
                    console.log('Saved to PostgreSQL');
                    if (!silent) {
                        showSaveIndicator('Saved to Database');
                    }
                } else {
                    throw new Error('API error');
                }
            } catch (error) {
                console.warn('PostgreSQL save failed, using localStorage fallback:', error);
                // Fallback to localStorage
                localStorage.setItem('peter_week2_homework', JSON.stringify(data));
                if (!silent) {
                    showSaveIndicator('Saved Locally');
                }
            }
        }

        async function loadProgress() {
            // Try to load from PostgreSQL first
            try {
                const response = await fetch(`${API_BASE}/api/homework/${CLIENT_EMAIL}/${HOMEWORK_TYPE}`);
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.homework && result.homework.responses) {
                        // Parse responses if it's a string (from JSONB)
                        const data = typeof result.homework.responses === 'string'
                            ? JSON.parse(result.homework.responses)
                            : result.homework.responses;
                        textareas.forEach(textarea => {
                            if (data[textarea.id]) {
                                textarea.value = data[textarea.id];
                            }
                        });
                        console.log('Loaded from PostgreSQL');
                        updateProgressBar();
                        return;
                    }
                }
            } catch (error) {
                console.warn('PostgreSQL load failed:', error);
            }

            // Fallback to localStorage
            const saved = localStorage.getItem('peter_week2_homework');
            if (saved) {
                const data = JSON.parse(saved);
                textareas.forEach(textarea => {
                    if (data[textarea.id]) {
                        textarea.value = data[textarea.id];
                    }
                });
                console.log('Loaded from localStorage');
            }
        }

        function calculateProgress() {
            let filled = 0;
            textareas.forEach(textarea => {
                if (textarea.value.trim().length > 20) {
                    filled++;
                }
            });
            return Math.round((filled / textareas.length) * 100);
        }

        function showSaveIndicator(message = 'Progress Saved') {
            const indicator = document.getElementById('saveIndicator');
            indicator.textContent = message;
            indicator.classList.add('visible');
            setTimeout(() => {
                indicator.classList.remove('visible');
            }, 2000);
        }

        function updateProgressBar() {
            let filled = 0;
            textareas.forEach(textarea => {
                if (textarea.value.trim().length > 20) {
                    filled++;
                }
            });

            const percent = Math.round((filled / textareas.length) * 100);
            document.getElementById('progressPercent').textContent = percent;
            document.getElementById('progressFill').style.width = percent + '%';
        }

        async function emailToLisa() {
            // Build the homework content
            let body = "WEEK 2 HOMEWORK - Peter Morgan\n";
            body += "=".repeat(40) + "\n\n";

            body += "KEY QUESTIONS\n";
            body += "-".repeat(20) + "\n\n";

            const questions = [
                "1. What does success look like in the next 12 months?",
                "2. Environments that let you thrive vs. frustrated you?",
                "3. Ideal role - what would you be doing day-to-day?",
                "4. The bigger impact you want to have?"
            ];

            const qIds = ['q1', 'q2', 'q3', 'q4'];
            questions.forEach((q, i) => {
                body += q + "\n";
                body += document.getElementById(qIds[i]).value || "(Not yet answered)";
                body += "\n\n";
            });

            body += "\nHOMEWORK TASKS\n";
            body += "-".repeat(20) + "\n\n";

            const hwTasks = [
                "1. Drains & Charges validation",
                "2. Dream Companies",
                "3. Hell Yes Criteria",
                "4. Unique Value Proposition"
            ];

            const hwIds = ['hw1', 'hw2', 'hw3', 'hw4'];
            hwTasks.forEach((task, i) => {
                body += task + "\n";
                body += document.getElementById(hwIds[i]).value || "(Not yet completed)";
                body += "\n\n";
            });

            // Try to send via API first
            try {
                const response = await fetch(`${API_BASE}/api/send-homework-email`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        client_name: 'Peter Morgan',
                        client_email: CLIENT_EMAIL,
                        homework_type: 'Week 2 Homework',
                        content: body
                    })
                });

                if (response.ok) {
                    showSaveIndicator('Sent to Lisa!');
                    alert('Your homework has been sent to Lisa!\n\nShe will review it before your next session.');
                    return;
                }
            } catch (error) {
                console.warn('API email failed, trying mailto fallback:', error);
            }

            // Fallback: mailto
            const subject = encodeURIComponent("Week 2 Homework - Peter Morgan");
            const truncatedBody = body.length > 1800 ? body.substring(0, 1800) + "\n\n[Content truncated - see full version in portal]" : body;
            const mailto = `mailto:lisa@harnessthespark.com?subject=${subject}&body=${encodeURIComponent(truncatedBody)}`;

            const link = document.createElement('a');
            link.href = mailto;
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            setTimeout(() => {
                const didWork = confirm('Did your email app open?\n\nClick "OK" if it worked.\nClick "Cancel" to copy your homework to clipboard instead.');

                if (!didWork) {
                    navigator.clipboard.writeText(body).then(() => {
                        alert('Copied to clipboard!\n\nNow paste it into an email to:\nlisa@harnessthespark.com\n\nSubject: Week 2 Homework - Peter Morgan');
                        showSaveIndicator('Copied to clipboard');
                    }).catch(() => {
                        const copyArea = document.createElement('textarea');
                        copyArea.value = body;
                        copyArea.style.cssText = 'position:fixed;top:10%;left:10%;width:80%;height:80%;z-index:10000;padding:20px;font-family:monospace;font-size:12px;';
                        document.body.appendChild(copyArea);
                        copyArea.select();
                        alert('Please manually copy the text shown, then paste into an email to:\nlisa@harnessthespark.com\n\nClick anywhere outside the text box to close it.');
                        copyArea.addEventListener('blur', () => copyArea.remove());
                    });
                } else {
                    showSaveIndicator('Email opened');
                }
            }, 1500);
        }

        function downloadHomework() {
            const content = document.createElement('div');
            content.innerHTML = `
                <div style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; max-width: 800px; margin: 0 auto; padding: 40px; color: #2c3e50;">
                    <div style="text-align: center; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 3px solid #7c3aed;">
                        <h1 style="color: #7c3aed; font-size: 2em; margin-bottom: 10px;">Week 2 Homework</h1>
                        <p style="font-size: 1.2em; color: #64748b;">Peter Morgan | Career Booster Programme</p>
                        <p style="font-size: 0.9em; color: #94a3b8;">Generated: ${new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' })}</p>
                    </div>

                    <h2 style="color: #7c3aed; border-bottom: 2px solid #7c3aed; padding-bottom: 10px; margin-top: 40px;">Key Questions</h2>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">1. What does success look like in the next 12 months?</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('q1')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">2. Environments that let you thrive vs. frustrated you?</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('q2')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">3. Ideal role - what would you be doing day-to-day?</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('q3')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">4. The bigger impact you want to have?</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('q4')?.value || '(Not yet completed)'}</div>
                    </div>

                    <h2 style="color: #7c3aed; border-bottom: 2px solid #7c3aed; padding-bottom: 10px; margin-top: 40px;">Homework Tasks</h2>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">1. Drains & Charges Validation</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('hw1')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">2. Dream Companies</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('hw2')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">3. Hell Yes Criteria</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('hw3')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="margin: 25px 0; padding: 20px; background: #f8fafc; border-radius: 10px;">
                        <h3 style="color: #1e293b; margin-bottom: 15px;">4. Unique Value Proposition</h3>
                        <div style="white-space: pre-wrap; line-height: 1.7;">${document.getElementById('hw4')?.value || '(Not yet completed)'}</div>
                    </div>

                    <div style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 2px solid #e2e8f0; color: #94a3b8; font-size: 0.9em;">
                        <p>Career Booster Programme with Lisa Gills | Harness the Spark</p>
                    </div>
                </div>
            `;

            if (typeof html2pdf !== 'undefined') {
                const opt = {
                    margin: [15, 15, 15, 15],
                    filename: 'Peter_Morgan_Week2_Homework.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, useCORS: true },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                };

                showSaveIndicator('Generating PDF...');
                html2pdf().set(opt).from(content).save().then(() => {
                    showSaveIndicator('Downloaded!');
                });
            } else {
                let htmlContent = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Peter Morgan - Week 2 Homework</title></head><body>${content.innerHTML}</body></html>`;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'Peter_Morgan_Week2_Homework.html';
                a.click();
                URL.revokeObjectURL(url);
                showSaveIndicator('Downloaded!');
            }
        }
    </script>
</body>
</html>
