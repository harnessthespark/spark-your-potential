<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spark Your Potential | Harness the Spark</title>
    <meta name="description" content="Discover the extraordinary abilities you think are ordinary. A powerful ability recognition exercise from Harness the Spark.">

    <!-- Tailwind CSS CDN -->
    <!-- Note: CDN is fine for standalone HTML files. Warning can be ignored for this use case. -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Configuration for Shadcn-style Design System -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        border: "hsl(214.3 31.8% 91.4%)",
                        input: "hsl(214.3 31.8% 91.4%)",
                        ring: "hsl(262.1 83.3% 57.8%)",
                        background: "hsl(0 0% 100%)",
                        foreground: "hsl(222.2 84% 4.9%)",
                        primary: {
                            DEFAULT: "hsl(262.1 83.3% 57.8%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        secondary: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)",
                        },
                        muted: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(215.4 16.3% 46.9%)",
                        },
                        accent: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)",
                        },
                    },
                    borderRadius: {
                        lg: "0.5rem",
                        md: "calc(0.5rem - 2px)",
                        sm: "calc(0.5rem - 4px)",
                    },
                }
            }
        }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: #1e293b;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: transparent;
            overflow: visible;
        }

        .header {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            color: white;
            padding: 48px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
            margin: 24px;
            border-radius: 20px;
            box-shadow: 0 10px 15px -3px rgba(124, 58, 237, 0.3);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at top right, rgba(255,255,255,0.1), transparent);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 12px;
            font-weight: 700;
            letter-spacing: -0.02em;
            position: relative;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
            font-weight: 400;
            position: relative;
        }

        .section {
            padding: 56px 40px;
            border-bottom: none;
            margin: 24px;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 2em;
            color: #1e293b;
            margin-bottom: 24px;
            text-align: center;
            font-weight: 700;
            letter-spacing: -0.02em;
            position: relative;
        }

        .section-title .checkmark {
            display: inline-block;
            margin-left: 12px;
            color: #10b981;
            font-size: 0.8em;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s ease;
        }

        .section-title .checkmark.visible {
            opacity: 1;
            transform: scale(1);
        }

        .visual-exercise {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 32px 0;
        }

        /* Evidence Collection - 3 column grid with Thread spanning right side */
        [data-section-number="1"] .visual-exercise {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: auto auto;
        }

        /* Outcomes 1-3 span first row */
        [data-section-number="1"] .evidence-box:nth-child(1),
        [data-section-number="1"] .evidence-box:nth-child(2),
        [data-section-number="1"] .evidence-box:nth-child(3) {
            grid-row: 1;
        }

        /* Outcomes 4-5 on second row, left side */
        [data-section-number="1"] .evidence-box:nth-child(4),
        [data-section-number="1"] .evidence-box:nth-child(5) {
            grid-row: 2;
        }

        /* The Thread spans right side of second row */
        [data-section-number="1"] .thread-box {
            grid-row: 2;
            grid-column: 3 / 4;
        }

        @media (max-width: 900px) {
            [data-section-number="1"] .visual-exercise {
                grid-template-columns: repeat(2, 1fr);
            }

            [data-section-number="1"] .thread-box {
                grid-column: 1 / -1;
                grid-row: auto;
            }
        }

        @media (max-width: 600px) {
            [data-section-number="1"] .visual-exercise {
                grid-template-columns: 1fr;
            }
        }

        /* What Finds You Section - Enhanced Layout */
        .what-finds-you-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 32px;
            max-width: 1100px;
            margin: 0 auto;
        }

        .magnet-box, .perception-box {
            min-height: 280px;
            padding: 2rem;
        }

        .magnet-box h3, .perception-box h3 {
            text-align: center;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: hsl(262.1 83.3% 57.8%);
        }

        .magnet-box textarea, .perception-box textarea {
            min-height: 140px;
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .what-finds-you-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
        }

        /* Effortless Ability Section - Enhanced Layout */
        .effortless-ability-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 32px;
            max-width: 1100px;
            margin: 0 auto;
        }

        .easy-box, .ofcourse-box {
            min-height: 280px;
            padding: 2rem;
        }

        .easy-box h3, .ofcourse-box h3 {
            text-align: center;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: hsl(262.1 83.3% 57.8%);
        }

        .easy-box textarea, .ofcourse-box textarea {
            min-height: 140px;
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .effortless-ability-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
        }

        /* Instinct Radar Section - Enhanced Layout */
        .instinct-radar-grid {
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .radar-question-box {
            min-height: 260px;
            padding: 2rem;
        }

        .radar-question-box h3 {
            text-align: center;
            font-size: 1.15rem;
            margin-bottom: 1.5rem;
            color: hsl(262.1 83.3% 57.8%);
        }

        .radar-question-box textarea {
            min-height: 120px;
            font-size: 0.95rem;
        }

        @media (max-width: 1024px) {
            .instinct-radar-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .radar-question-box:nth-child(3) {
                grid-column: 1 / -1;
                max-width: 600px;
                margin: 0 auto;
            }
        }

        @media (max-width: 600px) {
            .instinct-radar-grid {
                grid-template-columns: 1fr;
            }

            .radar-question-box:nth-child(3) {
                grid-column: auto;
                max-width: none;
            }
        }

        /* Shadcn-style Card Component */
        .evidence-box {
            background: hsl(0 0% 100%);
            border: 2px solid hsl(214.3 31.8% 91.4%);
            border-radius: 0.5rem;
            padding: 1.5rem;
            min-height: 180px;
            position: relative;
            transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.08);
            outline: 1px solid hsl(214.3 31.8% 95%);
            outline-offset: -1px;
        }

        /* The Thread box - full width on separate line */
        .thread-box {
            width: 100%;
            max-width: 100%;
        }

        .thread-box h3 {
            color: hsl(262.1 83.3% 57.8%);
            font-size: 1.25rem;
            font-weight: 700;
        }

        .thread-box textarea {
            min-height: 140px;
        }

        .evidence-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border-color: hsl(262.1 83.3% 57.8%);
        }

        .evidence-box h3 {
            color: hsl(222.2 84% 4.9%);
            margin-bottom: 1rem;
            font-size: 1rem;
            font-weight: 600;
            letter-spacing: -0.025em;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid hsl(214.3 31.8% 91.4%);
        }

        /* Shadcn-style Textarea Input */
        .evidence-box textarea {
            width: 100%;
            height: 110px;
            border: 1px solid hsl(214.3 31.8% 91.4%);
            background: hsl(0 0% 100%);
            resize: vertical;
            font-family: inherit;
            font-size: 0.875rem;
            line-height: 1.5rem;
            color: hsl(222.2 84% 4.9%);
            padding: 0.5rem 0.75rem;
            border-radius: calc(0.5rem - 2px);
            transition: all 150ms;
        }

        .evidence-box textarea:focus {
            outline: none;
            border-color: hsl(262.1 83.3% 57.8%);
            box-shadow: 0 0 0 2px hsl(262.1 83.3% 57.8% / 0.2);
        }

        .evidence-box textarea::placeholder {
            color: hsl(215.4 16.3% 46.9%);
            font-style: normal;
        }

        /* Shadcn-style Button Component */
        button, .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: calc(0.5rem - 2px);
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 150ms;
            cursor: pointer;
            outline: none;
            border: none;
        }

        button:focus-visible, .btn:focus-visible {
            outline: 2px solid hsl(262.1 83.3% 57.8%);
            outline-offset: 2px;
        }

        /* Primary Button (Shadcn default) */
        button.btn-primary, #saveToSheets {
            background: hsl(262.1 83.3% 57.8%);
            color: hsl(210 40% 98%);
            padding: 0.5rem 1rem;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }

        button.btn-primary:hover, #saveToSheets:hover {
            background: hsl(262.1 83.3% 52%);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        /* Secondary Button */
        button.btn-secondary, #saveResults {
            background: hsl(210 40% 96.1%);
            color: hsl(222.2 47.4% 11.2%);
            padding: 0.5rem 1rem;
            border: 1px solid hsl(214.3 31.8% 91.4%);
        }

        button.btn-secondary:hover, #saveResults:hover {
            background: hsl(210 40% 94%);
        }

        /* Outline Button */
        button.btn-outline, #emailResults {
            background: transparent;
            color: hsl(222.2 47.4% 11.2%);
            padding: 0.5rem 1rem;
            border: 1px solid hsl(214.3 31.8% 91.4%);
        }

        button.btn-outline:hover, #emailResults:hover {
            background: hsl(210 40% 96.1%);
        }

        .char-counter {
            font-size: 0.75em;
            color: hsl(215.4 16.3% 46.9%);
            text-align: right;
            margin-top: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .char-counter.visible {
            opacity: 1;
        }

        .char-counter.good {
            color: hsl(142.1 76.2% 36.3%);
            font-weight: 600;
        }

        
        .pattern-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1em;
            text-align: center;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .pattern-circle:hover {
            transform: scale(1.05);
        }
        
        .instinct-radar {
            width: 400px;
            height: 400px;
            margin: 40px auto;
            position: relative;
            border: 3px solid #3498db;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(52,152,219,0.15) 0%, rgba(255,255,255,0.95) 100%);
            box-shadow: 0 4px 20px rgba(52, 152, 219, 0.2);
        }

        .instinct-point {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #e74c3c;
            border: 3px solid white;
            border-radius: 50%;
            opacity: 0;
            transition: all 0.5s ease;
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.6), 0 2px 8px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .instinct-label {
            position: absolute;
            font-size: 1em;
            color: #2c3e50;
            font-weight: bold;
            opacity: 0;
            transition: all 0.5s ease;
            white-space: nowrap;
            background: white;
            padding: 4px 8px;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 5;
        }

        .radar-line {
            position: absolute;
            width: 50%;
            height: 3px;
            background: linear-gradient(to right, #3498db, rgba(52, 152, 219, 0.2));
            top: 50%;
            left: 50%;
            transform-origin: left centre;
            opacity: 0.5;
        }

        .radar-line:nth-child(1) { transform: rotate(0deg) translateY(-1.5px); }
        .radar-line:nth-child(2) { transform: rotate(45deg) translateY(-1.5px); }
        .radar-line:nth-child(3) { transform: rotate(90deg) translateY(-1.5px); }
        .radar-line:nth-child(4) { transform: rotate(135deg) translateY(-1.5px); }

        .radar-center {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            background: #667eea;
            border: 3px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: pulse 2s infinite;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
            z-index: 8;
        }
        
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .transformation-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 32px 0;
            flex-wrap: wrap;
            gap: 16px;
        }

        .transform-box {
            flex: 1;
            min-width: 300px;
            margin: 20px;
            padding: 40px 35px;
            border-radius: 8px;
            text-align: center;
            position: relative;
            transition: all 0.4s ease;
            border: 18px solid;
            border-image-slice: 1;
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.3),
                0 0 0 2px rgba(255, 255, 255, 0.1) inset,
                0 0 0 4px rgba(0, 0, 0, 0.2) inset;
        }

        /* Ornate decorative corner embellishments */
        .transform-box::before {
            content: '‚óÜ';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 32px;
            z-index: 10;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            animation: floatOrnament 3s ease-in-out infinite;
        }

        @keyframes floatOrnament {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }

        /* Mirror glass surface with beveled edge effect */
        .transform-box::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            background:
                linear-gradient(135deg, rgba(255,255,255,0.25) 0%, transparent 30%, rgba(255,255,255,0.15) 70%, transparent 100%),
                linear-gradient(to bottom right, rgba(255,255,255,0.1), transparent);
            border-radius: 4px;
            pointer-events: none;
            z-index: 1;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.1) inset;
        }

        .transform-box:hover {
            transform: translateY(-5px);
            box-shadow:
                0 30px 80px rgba(0, 0, 0, 0.4),
                0 0 0 2px rgba(255, 255, 255, 0.2) inset,
                0 0 0 4px rgba(0, 0, 0, 0.3) inset;
        }

        .before-box {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            border-image: linear-gradient(135deg, #94a3b8 0%, #cbd5e1 25%, #e2e8f0 50%, #cbd5e1 75%, #94a3b8 100%) 1;
            color: white;
        }

        .before-box::before {
            color: #cbd5e1;
        }

        .after-box {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-image: linear-gradient(135deg, #6ee7b7 0%, #a7f3d0 25%, #d1fae5 50%, #a7f3d0 75%, #6ee7b7 100%) 1;
            color: white;
        }

        .after-box::before {
            color: #a7f3d0;
        }

        .transform-box h3 {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 4px;
            position: relative;
            z-index: 3;
            text-shadow: 0 3px 12px rgba(0, 0, 0, 0.6);
            font-family: 'Didot', 'Bodoni MT', 'Garamond', serif;
        }

        .arrow {
            font-size: 3em;
            color: #a855f7;
            margin: 0 24px;
            font-weight: 700;
            text-shadow:
                0 0 20px rgba(168, 85, 247, 0.8),
                0 0 40px rgba(168, 85, 247, 0.5);
            animation: arrowPulse 2s ease-in-out infinite;
        }

        @keyframes arrowPulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.8;
            }
            50% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        .recognition-summary {
            background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
            color: white;
            padding: 40px;
            border-radius: 24px;
            margin: 32px 0;
            box-shadow: 0 10px 20px -5px rgba(245, 158, 11, 0.3);
        }

        .summary-item {
            margin: 24px 0;
            padding: 20px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            border-left: 4px solid rgba(255,255,255,0.6);
            backdrop-filter: blur(10px);
        }

        .summary-item strong {
            display: block;
            margin-bottom: 12px;
            font-size: 1.1em;
            font-weight: 600;
        }

        .summary-item input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            font-size: 1em;
            background: rgba(255,255,255,0.95);
            color: #1e293b;
            font-family: inherit;
            transition: all 0.2s;
        }

        .summary-item input::placeholder {
            color: #64748b;
            opacity: 1;
        }

        .summary-item input:focus {
            outline: none;
            border-color: rgba(255,255,255,0.8);
            background: #ffffff;
        }

        .final-message {
            text-align: center;
            font-size: 1.5em;
            color: #1e293b;
            font-weight: 500;
            margin: 24px;
            padding: 48px 40px;
            background: #ffffff;
            border-radius: 20px;
            border: none;
            letter-spacing: -0.01em;
            line-height: 1.5;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        
        @media (max-width: 768px) {
            .transformation-flow {
                flex-direction: column;
            }
            .arrow {
                transform: rotate(90deg);
                margin: 20px 0;
            }
            .instinct-radar {
                width: 250px;
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                <img src="HTS Icon_trans copy.jpeg" alt="Harness the Spark Logo" style="width: 80px; height: 80px; margin-right: 20px; border-radius: 50%; object-fit: cover;">
                <div style="text-align: left;">
                    <div style="font-size: 1.8em; font-weight: bold; color: white; margin-bottom: 5px;">Harness the Spark</div>
                    <div style="font-size: 0.9em; opacity: 0.8; color: white;">Ignite Your Natural Abilities</div>
                </div>
            </div>
            <h1>Spark Your Potential</h1>
            <p>The extraordinary abilities you think are ordinary</p>
        </div>

        <!-- Progress Dots -->
        <div style="text-align: center; margin: 32px 24px; padding: 20px; background: white; border-radius: 16px; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);">
            <div id="progressDots" style="display: flex; justify-content: center; align-items: center; gap: 12px;">
                <div class="progress-dot" data-section="1" style="width: 12px; height: 12px; border-radius: 50%; background: #cbd5e1; transition: all 0.3s ease; cursor: pointer;"></div>
                <div class="progress-dot" data-section="2" style="width: 12px; height: 12px; border-radius: 50%; background: #cbd5e1; transition: all 0.3s ease; cursor: pointer;"></div>
                <div class="progress-dot" data-section="3" style="width: 12px; height: 12px; border-radius: 50%; background: #cbd5e1; transition: all 0.3s ease; cursor: pointer;"></div>
                <div class="progress-dot" data-section="4" style="width: 12px; height: 12px; border-radius: 50%; background: #cbd5e1; transition: all 0.3s ease; cursor: pointer;"></div>
                <div class="progress-dot" data-section="5" style="width: 12px; height: 12px; border-radius: 50%; background: #cbd5e1; transition: all 0.3s ease; cursor: pointer;"></div>
            </div>
            <p id="progressText" style="margin-top: 12px; font-size: 0.9em; color: #64748b;">0 of 5 sections completed</p>
        </div>

        <div class="section" data-section-number="1">
            <h2 class="section-title">üìä The Evidence Collection<span class="checkmark">‚úì</span></h2>
            <p style="text-align: center; font-size: 1.1em; margin-bottom: 30px; color: #7f8c8d;">
                Look at your last 5 client outcomes. What pattern emerges?
            </p>
            
            <div class="visual-exercise">
                <div class="evidence-box">
                    <h3>Outcome #1</h3>
                    <textarea placeholder="What changed for them? What did you notice they couldn't see? What came naturally to you?"></textarea>
                </div>
                <div class="evidence-box">
                    <h3>Outcome #2</h3>
                    <textarea placeholder="What changed for them? What did you notice they couldn't see? What came naturally to you?"></textarea>
                </div>
                <div class="evidence-box">
                    <h3>Outcome #3</h3>
                    <textarea placeholder="What changed for them? What did you notice they couldn't see? What came naturally to you?"></textarea>
                </div>
                <div class="evidence-box">
                    <h3>Outcome #4</h3>
                    <textarea placeholder="What changed for them? What did you notice they couldn't see? What came naturally to you?"></textarea>
                </div>
                <div class="evidence-box">
                    <h3>Outcome #5</h3>
                    <textarea placeholder="What changed for them? What did you notice they couldn't see? What came naturally to you?"></textarea>
                </div>
                <div class="evidence-box thread-box">
                    <h3>The Thread</h3>
                    <textarea id="threadText" placeholder="Looking across these outcomes, what's the common thread? What ability keeps showing up, even when you don't consciously plan it?"></textarea>
                </div>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button id="aiPatternBtn" style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    padding: 15px 40px;
                    font-size: 1.1em;
                    border-radius: 25px;
                    cursor: pointer;
                    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                    transition: all 0.3s ease;
                    font-weight: 600;
                ">‚ú® Help Me See Patterns with AI</button>
                <p style="color: rgba(255,255,255,0.6); font-size: 0.9em; margin-top: 10px;">
                    Claude AI will analyze your responses and reveal hidden patterns
                </p>
            </div>

            <div id="aiInsights" style="
                background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
                border-radius: 20px;
                padding: 30px;
                margin: 20px 0;
                display: none;
                border-left: 5px solid #667eea;
                box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            ">
                <h3 style="color: #667eea; margin-bottom: 20px; font-size: 1.5em;">
                    üîÆ AI Pattern Recognition
                </h3>
                <div id="aiAnalysis" style="
                    color: #2c3e50;
                    line-height: 1.8;
                    font-size: 1.05em;
                "></div>
            </div>
        </div>

        <div class="section" data-section-number="2">
            <h2 class="section-title">üéØ The Instinct Radar<span class="checkmark">‚úì</span></h2>
            <p style="text-align: center; font-size: 1.1em; margin-bottom: 30px; color: #7f8c8d;">
                Your intuition is data. What does it tell you?
            </p>
            
            <div class="instinct-radar" id="instinctRadar">
                <div class="radar-line"></div>
                <div class="radar-line"></div>
                <div class="radar-line"></div>
                <div class="radar-line"></div>
                <div class="radar-center"></div>
                <!-- Insight points will be added dynamically -->
            </div>
            
            <button onclick="analyseInstincts()" style="display: block; margin: 20px auto; padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">Analyse My Instincts</button>
            
            <div class="visual-exercise instinct-radar-grid">
                <div class="evidence-box radar-question-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">‚ö°</span>
                    </div>
                    <h3>When You Knew Before You Knew</h3>
                    <textarea placeholder="Describe a time your gut feeling about a client was right. What did you sense? How quickly?"></textarea>
                </div>
                <div class="evidence-box radar-question-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">‚ùì</span>
                    </div>
                    <h3>The Questions Only You Ask</h3>
                    <textarea placeholder="What questions do you find yourself asking that others don't think to ask?"></textarea>
                </div>
                <div class="evidence-box radar-question-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">üéØ</span>
                    </div>
                    <h3>What You Notice First</h3>
                    <textarea placeholder="What do you notice about people or situations that others seem to miss completely?"></textarea>
                </div>
            </div>
        </div>

        <div class="section" data-section-number="3">
            <h2 class="section-title">‚ö° The Effortless Ability<span class="checkmark">‚úì</span></h2>
            <p style="text-align: center; font-size: 1.1em; margin-bottom: 40px; color: #64748b; max-width: 800px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                The skills that feel effortless to you are often your most valuable abilities
            </p>
            <div class="visual-exercise effortless-ability-grid">
                <div class="evidence-box easy-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">üí´</span>
                    </div>
                    <h3>What Feels Easy to You</h3>
                    <textarea placeholder="What part of your work feels so natural you almost don't count it as a skill?"></textarea>
                </div>
                <div class="evidence-box ofcourse-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">üí°</span>
                    </div>
                    <h3>The "Of Course" Moments</h3>
                    <textarea placeholder="What do you do that makes clients say 'of course' afterward - but they couldn't see it before?"></textarea>
                </div>
            </div>
        </div>

        <div class="section" data-section-number="4">
            <h2 class="section-title">üîÑ The Transformation Mirror<span class="checkmark">‚úì</span></h2>
            <p style="text-align: center; font-size: 1.1em; margin-bottom: 30px; color: #7f8c8d;">
                Think of a client who changed significantly through working with you
            </p>
            
            <div class="transformation-flow">
                <div class="transform-box before-box">
                    <h3>Before</h3>
                    <textarea class="mirror-textarea" placeholder="Who were they before? How did they think and act?"></textarea>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="transform-box after-box">
                    <h3>After</h3>
                    <textarea class="mirror-textarea" placeholder="Who are they now? What's different about how they operate?"></textarea>
                </div>
            </div>

            <style>
                .mirror-textarea {
                    background: rgba(255, 255, 255, 0.95);
                    color: #2c3e50;
                    height: 120px;
                    width: 100%;
                    padding: 15px;
                    border: 2px solid rgba(102, 126, 234, 0.3);
                    border-radius: 12px;
                    font-size: 1em;
                    font-family: inherit;
                    resize: vertical;
                    position: relative;
                    z-index: 3;
                    backdrop-filter: blur(5px);
                    transition: all 0.3s ease;
                }

                .mirror-textarea:focus {
                    outline: none;
                    background: rgba(255, 255, 255, 1);
                    border-color: #667eea;
                    box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
                }

                .mirror-textarea::placeholder {
                    color: rgba(44, 62, 80, 0.5) !important;
                    opacity: 1 !important;
                    font-style: italic;
                }
            </style>


            <div class="evidence-box" style="margin-top: 30px;">
                <h3>The Unlock Moment</h3>
                <textarea id="unlockMoment" placeholder="When do breakthroughs happen with your clients? What do you do right before the unlock moment? Describe the moment when everything shifts."></textarea>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button id="aiUnlockBtn" style="
                    background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
                    color: white;
                    border: none;
                    padding: 15px 40px;
                    font-size: 1.1em;
                    border-radius: 25px;
                    cursor: pointer;
                    box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3);
                    transition: all 0.3s ease;
                    font-weight: 600;
                ">üîì Reveal My Unlock Pattern with AI</button>
                <p style="color: rgba(255,255,255,0.6); font-size: 0.9em; margin-top: 10px;">
                    Claude AI will analyze your transformation stories and unlock moments
                </p>
            </div>

            <div id="aiUnlockInsights" style="
                background: linear-gradient(135deg, rgba(155, 89, 182, 0.1), rgba(142, 68, 173, 0.1));
                border-radius: 20px;
                padding: 30px;
                margin: 20px 0;
                display: none;
                border-left: 5px solid #9b59b6;
                box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            ">
                <h3 style="color: #9b59b6; margin-bottom: 20px; font-size: 1.5em;">
                    üîì Your Unlock Pattern Revealed
                </h3>
                <div id="aiUnlockAnalysis" style="
                    color: #2c3e50;
                    line-height: 1.8;
                    font-size: 1.05em;
                "></div>
            </div>
        </div>

        <div class="section" data-section-number="5">
            <h2 class="section-title">üß≤ What Finds You<span class="checkmark">‚úì</span></h2>
            <p style="text-align: center; font-size: 1.1em; margin-bottom: 40px; color: #64748b; max-width: 800px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                The problems and people that naturally gravitate towards you reveal your unique magnetism
            </p>
            <div class="visual-exercise what-finds-you-grid">
                <div class="evidence-box magnet-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">üß≤</span>
                    </div>
                    <h3>The Problem Magnet</h3>
                    <textarea placeholder="What types of problems do people bring to you, even when it's not what you advertise?"></textarea>
                </div>
                <div class="evidence-box perception-box">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <span style="font-size: 3em;">üëÅÔ∏è</span>
                    </div>
                    <h3>How Others See You</h3>
                    <textarea placeholder="When people refer others to you, what words do they use? What situations make them think of you?"></textarea>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="recognition-summary">
                <h2 style="text-align: center; margin-bottom: 30px;">‚ú® The Recognition Summary</h2>
                
                <div class="summary-item">
                    <strong>Your name (optional):</strong>
                    <input type="text" placeholder="So we can identify your responses" id="clientName">
                </div>
                
                <div class="summary-item">
                    <strong>The ability I've been underestimating:</strong>
                    <input type="text" placeholder="What capability have you been treating as smaller than it is?">
                </div>
                
                <div class="summary-item">
                    <strong>The pattern I now see:</strong>
                    <input type="text" placeholder="What thread runs through all your best work?">
                </div>
                
                <div class="summary-item">
                    <strong>The transformation I enable:</strong>
                    <input type="text" placeholder="What consistent change do you create in people?">
                </div>
                
                <div class="summary-item">
                    <strong>The permission I'm giving myself:</strong>
                    <input type="text" placeholder="What are you now willing to claim about what you can do?">
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button id="saveToSheets" style="
                        background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
                        color: white;
                        border: none;
                        padding: 16px 32px;
                        font-size: 1.1em;
                        font-weight: 600;
                        border-radius: 12px;
                        cursor: pointer;
                        margin: 0 10px;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 6px -1px rgba(124, 58, 237, 0.3);
                    " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(124, 58, 237, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px -1px rgba(124, 58, 237, 0.3)'">Submit Answers</button>

                    <button id="saveResults" style="
                        background: rgba(255,255,255,0.2);
                        color: white;
                        border: 2px solid rgba(255,255,255,0.5);
                        padding: 15px 30px;
                        font-size: 1.1em;
                        border-radius: 10px;
                        cursor: pointer;
                        margin: 0 10px;
                        transition: all 0.3s ease;
                    ">Save My Results</button>

                    <button id="emailResults" style="
                        background: rgba(255,255,255,0.9);
                        color: #e67e22;
                        border: 2px solid rgba(255,255,255,0.5);
                        padding: 15px 30px;
                        font-size: 1.1em;
                        border-radius: 10px;
                        cursor: pointer;
                        margin: 0 10px;
                        transition: all 0.3s ease;
                    ">Email My Results</button>

                    <button id="clearAll" style="
                        background: transparent;
                        color: rgba(255,255,255,0.6);
                        border: 1px solid rgba(255,255,255,0.3);
                        padding: 10px 20px;
                        font-size: 0.9em;
                        border-radius: 10px;
                        cursor: pointer;
                        margin: 10px 10px 0 10px;
                        transition: all 0.3s ease;
                    ">Clear All Responses</button>
                </div>
            </div>
        </div>

        <div class="final-message">
            The goal isn't to become someone new.<br>
            It's to recognise who you already are.
        </div>
    </div>


    <script>
        // Add subtle interactions
        document.querySelectorAll('.evidence-box').forEach(box => {
            box.addEventListener('click', function() {
                this.style.borderLeftColor = '#e74c3c';
                const textarea = this.querySelector('textarea');
                if (textarea) textarea.focus();
            });
        });

        // Instinct Radar Analysis
        function analyseInstincts() {
            const radar = document.getElementById('instinctRadar');
            const intuition = document.querySelector('textarea[placeholder*="gut feeling"]').value;
            const questions = document.querySelector('textarea[placeholder*="questions do you find"]').value;
            const noticing = document.querySelector('textarea[placeholder*="notice about people"]').value;

            // Clear existing points
            radar.querySelectorAll('.instinct-point, .instinct-label').forEach(el => el.remove());

            const insights = [];

            // Analyse intuition speed
            if (intuition.toLowerCase().includes('quick') || intuition.toLowerCase().includes('immediate') || intuition.toLowerCase().includes('instant')) {
                insights.push({ label: 'Rapid Pattern Recognition', angle: 45, distance: 80 });
            }

            // Analyse intuition accuracy
            if (intuition.toLowerCase().includes('right') || intuition.toLowerCase().includes('correct') || intuition.toLowerCase().includes('accurate')) {
                insights.push({ label: 'High Intuitive Accuracy', angle: 135, distance: 90 });
            }

            // Analyse question depth
            if (questions.toLowerCase().includes('why') || questions.toLowerCase().includes('deeper') || questions.toLowerCase().includes('root')) {
                insights.push({ label: 'Deep Inquiry Mind', angle: 225, distance: 85 });
            }

            // Analyse unique perspective
            if (questions.toLowerCase().includes('different') || questions.toLowerCase().includes('unique') || questions.toLowerCase().includes('others don')) {
                insights.push({ label: 'Unique Perspective', angle: 315, distance: 75 });
            }

            // Analyse observational skills (NEW - 3rd question)
            if (noticing.toLowerCase().includes('body language') || noticing.toLowerCase().includes('energy') || noticing.toLowerCase().includes('feeling') || noticing.toLowerCase().includes('vibe')) {
                insights.push({ label: 'Empathic Sensing', angle: 180, distance: 85 });
            }

            // Analyse detail detection (NEW - 3rd question)
            if (noticing.toLowerCase().includes('detail') || noticing.toLowerCase().includes('subtle') || noticing.toLowerCase().includes('small') || noticing.toLowerCase().includes('notice')) {
                insights.push({ label: 'Detail Detection', angle: 270, distance: 80 });
            }

            // Analyse pattern spotting (NEW - 3rd question)
            if (noticing.toLowerCase().includes('pattern') || noticing.toLowerCase().includes('always') || noticing.toLowerCase().includes('tend') || noticing.toLowerCase().includes('usually')) {
                insights.push({ label: 'Pattern Spotting', angle: 90, distance: 75 });
            }

            // Add any text length insights
            if (intuition.length > 100 || questions.length > 100 || noticing.length > 100) {
                insights.push({ label: 'Rich Awareness', angle: 0, distance: 70 });
            }
            
            // Display insights on radar
            insights.forEach((insight, index) => {
                setTimeout(() => {
                    const point = document.createElement('div');
                    point.className = 'instinct-point';
                    const label = document.createElement('div');
                    label.className = 'instinct-label';
                    label.textContent = insight.label;
                    
                    // Calculate position
                    const centerX = 150;
                    const centerY = 150;
                    const radians = (insight.angle - 90) * Math.PI / 180;
                    const x = centerX + Math.cos(radians) * insight.distance;
                    const y = centerY + Math.sin(radians) * insight.distance;
                    
                    point.style.left = (x - 6) + 'px';
                    point.style.top = (y - 6) + 'px';
                    
                    // Position label
                    label.style.left = (x + 10) + 'px';
                    label.style.top = (y - 10) + 'px';
                    
                    radar.appendChild(point);
                    radar.appendChild(label);
                    
                    // Animate in
                    setTimeout(() => {
                        point.style.opacity = '1';
                        label.style.opacity = '1';
                    }, 50);
                }, index * 300);
            });
        }
        
        // Trigger analysis when instinct textareas change
        const instinctSection = document.querySelectorAll('.section')[1]; // Second section
        if (instinctSection) {
            instinctSection.querySelectorAll('textarea').forEach(textarea => {
                textarea.addEventListener('blur', analyseInstincts);
                textarea.addEventListener('change', analyseInstincts);
            });
        }

        // Create save indicator
        const saveIndicator = document.createElement('div');
        saveIndicator.id = 'saveIndicator';
        saveIndicator.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9em;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        `;
        saveIndicator.textContent = '‚úì Saved';
        document.body.appendChild(saveIndicator);

        // Auto-save to localStorage with visual feedback
        document.querySelectorAll('textarea, input').forEach(element => {
            element.addEventListener('input', function() {
                const key = this.placeholder || this.closest('.evidence-box, .transform-box')?.querySelector('h3')?.textContent || 'input';
                try {
                    localStorage.setItem('ability_' + key, this.value);

                    // Show save indicator
                    saveIndicator.style.opacity = '1';
                    setTimeout(() => {
                        saveIndicator.style.opacity = '0';
                    }, 1500);
                } catch (e) {
                    console.error('Failed to save:', e);
                    saveIndicator.textContent = '‚ö† Save failed';
                    saveIndicator.style.background = '#e74c3c';
                    saveIndicator.style.opacity = '1';
                    setTimeout(() => {
                        saveIndicator.style.opacity = '0';
                        saveIndicator.textContent = '‚úì Saved';
                        saveIndicator.style.background = '#27ae60';
                    }, 3000);
                }
            });

            // Load saved data
            const key = element.placeholder || element.closest('.evidence-box, .transform-box')?.querySelector('h3')?.textContent || 'input';
            const saved = localStorage.getItem('ability_' + key);
            if (saved) element.value = saved;
        });

        // Collect all responses
        function collectAllResponses() {
            const responses = {};

            // Get all textarea responses from evidence boxes
            document.querySelectorAll('.evidence-box').forEach(box => {
                const title = box.querySelector('h3').textContent;
                const content = box.querySelector('textarea').value;
                responses[title] = content;
            });

            // Get transformation textareas (Before/After)
            document.querySelectorAll('.transform-box').forEach(box => {
                const title = box.querySelector('h3').textContent;
                const content = box.querySelector('textarea').value;
                responses[title] = content;
            });

            // Get summary responses
            document.querySelectorAll('.summary-item').forEach(item => {
                const title = item.querySelector('strong').textContent;
                const content = item.querySelector('input').value;
                responses[title] = content;
            });

            // ‚ú® NEW: Collect AI-generated pattern analysis
            const aiAnalysisDiv = document.getElementById('aiAnalysis');
            if (aiAnalysisDiv && aiAnalysisDiv.textContent.trim() &&
                !aiAnalysisDiv.textContent.includes('Claude AI is analyzing')) {
                // Get the text content, removing any "Unable to analyze" messages
                const analysisText = aiAnalysisDiv.innerText || aiAnalysisDiv.textContent;
                if (analysisText && !analysisText.includes('Unable to analyze')) {
                    responses['AI Pattern Analysis'] = analysisText.trim();
                }
            }

            // ‚ú® NEW: Collect AI-generated unlock pattern
            const aiUnlockDiv = document.getElementById('aiUnlockAnalysis');
            if (aiUnlockDiv && aiUnlockDiv.textContent.trim() &&
                !aiUnlockDiv.textContent.includes('Claude AI is analyzing')) {
                // Get the text content, removing any "Unable to analyze" messages
                const unlockText = aiUnlockDiv.innerText || aiUnlockDiv.textContent;
                if (unlockText && !unlockText.includes('Unable to analyze')) {
                    responses['AI Unlock Pattern'] = unlockText.trim();
                }
            }

            return responses;
        }

        // Format responses for sharing
        function formatResponses() {
            const responses = collectAllResponses();
            const date = new Date().toLocaleDateString('en-GB');
            
            let formatted = `SPARK YOUR POTENTIAL - ${date}\n`;
            formatted += `${'='.repeat(50)}\n\n`;
            
            formatted += `THE EVIDENCE COLLECTION\n`;
            formatted += `${'-'.repeat(25)}\n`;
            for (let i = 1; i <= 5; i++) {
                const outcome = responses[`Outcome #${i}`] || '';
                if (outcome) {
                    formatted += `Outcome #${i}:\n${outcome}\n\n`;
                }
            }
            
            formatted += `THE INSTINCT AUDIT\n`;
            formatted += `${'-'.repeat(18)}\n`;
            const intuition = responses['When You Knew Before You Knew'] || '';
            const questions = responses['The Questions Only You Ask'] || '';
            const noticing = responses['What You Notice First'] || '';
            if (intuition) formatted += `When You Knew Before You Knew:\n${intuition}\n\n`;
            if (questions) formatted += `The Questions Only You Ask:\n${questions}\n\n`;
            if (noticing) formatted += `What You Notice First:\n${noticing}\n\n`;
            
            formatted += `THE EFFORTLESS ABILITY\n`;
            formatted += `${'-'.repeat(22)}\n`;
            const easy = responses['What Feels Easy to You'] || '';
            const ofCourse = responses['The "Of Course" Moments'] || '';
            if (easy) formatted += `What Feels Easy:\n${easy}\n\n`;
            if (ofCourse) formatted += `"Of Course" Moments:\n${ofCourse}\n\n`;
            
            formatted += `THE TRANSFORMATION MIRROR\n`;
            formatted += `${'-'.repeat(26)}\n`;
            const before = responses['Before'] || '';
            const after = responses['After'] || '';
            if (before) formatted += `Client Before:\n${before}\n\n`;
            if (after) formatted += `Client After:\n${after}\n\n`;
            
            formatted += `WHAT FINDS YOU\n`;
            formatted += `${'-'.repeat(15)}\n`;
            const magnet = responses['The Problem Magnet'] || '';
            const referrals = responses['How Others See You'] || '';
            if (magnet) formatted += `Problem Magnet:\n${magnet}\n\n`;
            if (referrals) formatted += `How Others See You:\n${referrals}\n\n`;
            
            formatted += `RECOGNITION SUMMARY\n`;
            formatted += `${'-'.repeat(18)}\n`;
            const ability = responses['The ability I\'ve been underestimating:'] || '';
            const pattern = responses['The pattern I now see:'] || '';
            const transformation = responses['The transformation I enable:'] || '';
            const permission = responses['The permission I\'m giving myself:'] || '';

            if (ability) formatted += `Underestimated Ability:\n${ability}\n\n`;
            if (pattern) formatted += `Pattern Recognised:\n${pattern}\n\n`;
            if (transformation) formatted += `Transformation I Enable:\n${transformation}\n\n`;
            if (permission) formatted += `Permission I'm Giving Myself:\n${permission}\n\n`;

            // ‚ú® NEW: Add AI-generated insights to report
            const aiPatternAnalysis = responses['AI Pattern Analysis'] || '';
            const aiUnlockPattern = responses['AI Unlock Pattern'] || '';

            if (aiPatternAnalysis || aiUnlockPattern) {
                formatted += `AI-GENERATED INSIGHTS\n`;
                formatted += `${'-'.repeat(22)}\n`;

                if (aiPatternAnalysis) {
                    formatted += `üîÆ AI Pattern Analysis:\n${aiPatternAnalysis}\n\n`;
                }

                if (aiUnlockPattern) {
                    formatted += `üîì AI Unlock Pattern:\n${aiUnlockPattern}\n\n`;
                }
            }

            return formatted;
        }

        // Generate Beautiful HTML Report
        function generateBeautifulReport() {
            const responses = collectAllResponses();
            const date = new Date().toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            const clientName = document.getElementById('clientName').value || 'Your';

            const html = `<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${clientName} Transformation Blueprint - Harness the Spark</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: white;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
            padding-bottom: 30px;
            border-bottom: 3px solid #9b59b6;
        }

        .header h1 {
            font-size: 2.5em;
            color: #9b59b6;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 1.3em;
            color: #7f8c8d;
            margin-bottom: 20px;
            font-weight: 300;
        }

        .header .meta {
            font-size: 1em;
            color: #95a5a6;
            margin-top: 15px;
        }

        .section {
            margin-bottom: 50px;
            page-break-inside: avoid;
        }

        .section-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
            font-weight: 600;
        }

        .section-icon {
            font-size: 1.2em;
            margin-right: 10px;
        }

        .content-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #9b59b6;
        }

        .content-box h3 {
            color: #9b59b6;
            font-size: 1.2em;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .content-box p {
            color: #34495e;
            font-size: 1.05em;
            line-height: 1.8;
            white-space: pre-wrap;
        }

        .ai-insight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .ai-insight-box h3 {
            font-size: 1.4em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .ai-insight-box p {
            font-size: 1.05em;
            line-height: 1.8;
            opacity: 0.95;
            white-space: pre-wrap;
        }

        .highlight-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
        }

        .highlight-box h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .highlight-box p {
            font-size: 1.1em;
            line-height: 1.8;
            white-space: pre-wrap;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 2px solid #ecf0f1;
            color: #95a5a6;
        }

        .footer strong {
            color: #9b59b6;
            display: block;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        @media print {
            body { padding: 20px; }
            .section { page-break-inside: avoid; }
            .content-box, .ai-insight-box, .highlight-box {
                break-inside: avoid;
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ú® ${clientName} Transformation Blueprint</h1>
            <div class="subtitle">Ability Recognition & Career Architecture</div>
            <div class="meta">Generated ${date} | Harness the Spark</div>
        </div>

        <div class="section">
            <h2 class="section-title"><span class="section-icon">üéØ</span>The Evidence Collection</h2>
            ${[1, 2, 3, 4, 5].map(i => {
                const outcome = responses[\`Outcome #\${i}\`];
                return outcome ? \`
                    <div class="content-box">
                        <h3>Outcome #\${i}</h3>
                        <p>\${outcome}</p>
                    </div>
                \` : '';
            }).join('')}
        </div>

        <div class="section">
            <h2 class="section-title"><span class="section-icon">üß†</span>The Instinct Audit</h2>
            ${responses['When You Knew Before You Knew'] ? \`
                <div class="content-box">
                    <h3>When You Knew Before You Knew</h3>
                    <p>\${responses['When You Knew Before You Knew']}</p>
                </div>
            \` : ''}
            ${responses['The Questions Only You Ask'] ? \`
                <div class="content-box">
                    <h3>The Questions Only You Ask</h3>
                    <p>\${responses['The Questions Only You Ask']}</p>
                </div>
            \` : ''}
            ${responses['What You Notice First'] ? \`
                <div class="content-box">
                    <h3>What You Notice First</h3>
                    <p>\${responses['What You Notice First']}</p>
                </div>
            \` : ''}
        </div>

        <div class="section">
            <h2 class="section-title"><span class="section-icon">‚ö°</span>The Effortless Ability</h2>
            ${responses['What Feels Easy to You'] ? \`
                <div class="content-box">
                    <h3>What Feels Easy to You</h3>
                    <p>\${responses['What Feels Easy to You']}</p>
                </div>
            \` : ''}
            ${responses['The "Of Course" Moments'] ? \`
                <div class="content-box">
                    <h3>The "Of Course" Moments</h3>
                    <p>\${responses['The "Of Course" Moments']}</p>
                </div>
            \` : ''}
        </div>

        <div class="section">
            <h2 class="section-title"><span class="section-icon">üîÑ</span>The Transformation Mirror</h2>
            ${responses['Before'] ? \`
                <div class="content-box">
                    <h3>Before</h3>
                    <p>\${responses['Before']}</p>
                </div>
            \` : ''}
            ${responses['After'] ? \`
                <div class="content-box">
                    <h3>After</h3>
                    <p>\${responses['After']}</p>
                </div>
            \` : ''}
        </div>

        <div class="section">
            <h2 class="section-title"><span class="section-icon">üß≤</span>What Finds You</h2>
            ${responses['The Problem Magnet'] ? \`
                <div class="content-box">
                    <h3>The Problem Magnet</h3>
                    <p>\${responses['The Problem Magnet']}</p>
                </div>
            \` : ''}
            ${responses['How Others See You'] ? \`
                <div class="content-box">
                    <h3>How Others See You</h3>
                    <p>\${responses['How Others See You']}</p>
                </div>
            \` : ''}
        </div>

        ${responses['AI Pattern Analysis'] ? \`
            <div class="section">
                <h2 class="section-title"><span class="section-icon">üîÆ</span>AI Pattern Recognition</h2>
                <div class="ai-insight-box">
                    <h3>Your Hidden Patterns Revealed</h3>
                    <p>\${responses['AI Pattern Analysis']}</p>
                </div>
            </div>
        \` : ''}

        ${responses['AI Unlock Pattern'] ? \`
            <div class="section">
                <h2 class="section-title"><span class="section-icon">üîì</span>Your Unlock Pattern</h2>
                <div class="ai-insight-box">
                    <h3>The Pattern That Unlocks Everything</h3>
                    <p>\${responses['AI Unlock Pattern']}</p>
                </div>
            </div>
        \` : ''}

        <div class="section">
            <h2 class="section-title"><span class="section-icon">‚ú®</span>Recognition Summary</h2>
            ${responses['The ability I\\'ve been underestimating:'] ? \`
                <div class="highlight-box">
                    <h3>The Ability I've Been Underestimating</h3>
                    <p>\${responses['The ability I\\'ve been underestimating:']}</p>
                </div>
            \` : ''}
            ${responses['The pattern I now see:'] ? \`
                <div class="highlight-box">
                    <h3>The Pattern I Now See</h3>
                    <p>\${responses['The pattern I now see:']}</p>
                </div>
            \` : ''}
            ${responses['The transformation I enable:'] ? \`
                <div class="highlight-box">
                    <h3>The Transformation I Enable</h3>
                    <p>\${responses['The transformation I enable:']}</p>
                </div>
            \` : ''}
            ${responses['The permission I\\'m giving myself:'] ? \`
                <div class="highlight-box">
                    <h3>The Permission I'm Giving Myself</h3>
                    <p>\${responses['The permission I\\'m giving myself:']}</p>
                </div>
            \` : ''}
        </div>

        <div class="footer">
            <strong>Harness the Spark</strong>
            <p>Your transformation blueprint for building a career that works with your unique abilities.</p>
            <p style="margin-top: 10px; font-size: 0.9em;">Generated ${date}</p>
        </div>
    </div>
</body>
</html>`;

            return html;
        }

        // Google Sheets configuration
        // IMPORTANT: Replace this URL with your Google Apps Script Web App URL
        // Instructions are in the google-apps-script.js file
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbwv7qIXwqxjLgIAsenTiRZC6fDoi50vf9zqq8O7KoiRTn_zVMq6s-y0cawDNLDOcww/exec';

        // Save to Google Sheets
        document.getElementById('saveToSheets').addEventListener('click', async function() {
            const responses = collectAllResponses();
            const button = this;

            // Check if URL has been configured
            if (GOOGLE_SHEETS_URL.includes('YOUR_SCRIPT_ID_HERE')) {
                alert('‚öôÔ∏è Google Sheets Not Configured\n\n' +
                      'To enable Google Sheets saving:\n\n' +
                      '1. Open the google-apps-script.js file\n' +
                      '2. Follow the setup instructions inside\n' +
                      '3. Copy your Web App URL\n' +
                      '4. Paste it in the HTML file (line 743)\n\n' +
                      'For now, use "Save My Results" or "Email My Results" buttons instead.');
                return;
            }

            // Show loading state
            button.style.background = '#FFA500';
            button.textContent = 'Saving to Sheets...';
            button.disabled = true;

            try {
                // Add timestamp and client info
                const data = {
                    timestamp: new Date().toISOString(),
                    clientName: document.getElementById('clientName').value || 'Anonymous',
                    ...responses
                };

                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Required for Google Apps Script
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                // With no-cors mode, we can't read the response, but if no error was thrown, it likely succeeded
                button.style.background = '#4CAF50';
                button.textContent = '‚úì Saved to Google Sheets!';

                // Also save locally as backup
                localStorage.setItem('last_save_timestamp', new Date().toISOString());

                setTimeout(() => {
                    button.style.background = 'linear-gradient(135deg, #7c3aed 0%, #a855f7 100%)';
                    button.textContent = 'Submit Answers';
                    button.disabled = false;
                }, 3000);

            } catch (error) {
                console.error('Error saving to sheets:', error);

                // Error state
                button.style.background = '#f44336';
                button.textContent = '‚ö† Error - Try Again';

                // Show detailed error
                alert('Error saving to Google Sheets:\n\n' + error.message + '\n\n' +
                      'Please check:\n' +
                      '1. Your Google Apps Script URL is correct\n' +
                      '2. The script is deployed as a web app\n' +
                      '3. Access is set to "Anyone"\n\n' +
                      'Use "Save My Results" as a backup.');

                setTimeout(() => {
                    button.style.background = 'linear-gradient(135deg, #7c3aed 0%, #a855f7 100%)';
                    button.textContent = 'Submit Answers';
                    button.disabled = false;
                }, 3000);
            }
        });

        // Generate Beautiful Report function (available via console for coach use)
        // Coach can call: window.generateAndDownloadReport() from browser console
        window.generateAndDownloadReport = function() {
            const htmlReport = generateBeautifulReport();
            const clientName = document.getElementById('clientName').value || 'Client';
            const fileName = `${clientName.replace(/\s+/g, '_')}_Transformation_Blueprint.html`;

            // Create blob and download
            const blob = new Blob([htmlReport], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);

            // Also open in new tab for immediate preview
            const newWindow = window.open();
            newWindow.document.write(htmlReport);
            newWindow.document.close();

            console.log('‚úÖ Beautiful report generated and downloaded!');
            return 'Report generated successfully';
        };

        document.getElementById('saveResults').addEventListener('click', function() {
            const responses = formatResponses();
            const blob = new Blob([responses], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ability-recognition-results.txt';
            a.click();
            URL.revokeObjectURL(url);

            this.style.background = 'rgba(46, 204, 113, 0.8)';
            this.textContent = 'Saved!';
            setTimeout(() => {
                this.style.background = 'rgba(255,255,255,0.2)';
                this.textContent = 'Save My Results';
            }, 2000);
        });

        // Email functionality
        document.getElementById('emailResults').addEventListener('click', function() {
            const responses = formatResponses();
            const subject = encodeURIComponent('My Spark Your Potential Results');
            const body = encodeURIComponent(responses);
            const mailtoLink = `mailto:?subject=${subject}&body=${body}`;
            
            // Try to open email client
            window.location.href = mailtoLink;
            
            // Also copy to clipboard as backup
            navigator.clipboard.writeText(responses).then(() => {
                this.textContent = 'Copied to Clipboard!';
                setTimeout(() => {
                    this.textContent = 'Email My Results';
                }, 2000);
            });
        });
        
        // Clear All Responses
        document.getElementById('clearAll').addEventListener('click', function() {
            if (confirm('‚ö†Ô∏è Are you sure you want to clear ALL responses?\n\nThis will delete all your saved data from this browser.\n\nThis action cannot be undone.')) {
                // Clear all textareas and inputs
                document.querySelectorAll('textarea, input[type="text"]').forEach(element => {
                    element.value = '';
                });

                // Clear localStorage
                const keys = Object.keys(localStorage);
                keys.forEach(key => {
                    if (key.startsWith('ability_')) {
                        localStorage.removeItem(key);
                    }
                });

                // Visual feedback
                this.style.background = '#27ae60';
                this.style.color = 'white';
                this.textContent = '‚úì All Responses Cleared';
                setTimeout(() => {
                    this.style.background = 'transparent';
                    this.style.color = 'rgba(255,255,255,0.6)';
                    this.textContent = 'Clear All Responses';
                }, 2000);

                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });

        // AI Pattern Detection with Claude
        document.getElementById('aiPatternBtn').addEventListener('click', async function() {
            const button = this;
            const insightsDiv = document.getElementById('aiInsights');
            const analysisDiv = document.getElementById('aiAnalysis');

            // Collect all outcomes
            const outcomes = [];
            document.querySelectorAll('.evidence-box').forEach(box => {
                const heading = box.querySelector('h3');
                const textarea = box.querySelector('textarea');
                if (heading && textarea && textarea.value.trim()) {
                    outcomes.push({
                        title: heading.textContent,
                        content: textarea.value.trim()
                    });
                }
            });

            // Check if enough data
            if (outcomes.length < 2) {
                alert('üìù Please fill in at least 2 outcome boxes before requesting AI analysis.');
                return;
            }

            // Show loading state
            button.disabled = true;
            button.style.opacity = '0.7';
            button.textContent = 'üîÆ Analyzing patterns...';
            insightsDiv.style.display = 'block';
            analysisDiv.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">‚ú® Claude AI is analyzing your responses...</p>';

            try {
                // Prepare outcomes data
                const outcomeTexts = outcomes.map(o => o.content);

                // Call backend API
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        outcomes: outcomeTexts,
                        type: 'patterns',
                        name: document.querySelector('input[placeholder*="optional"]')?.value || 'there'
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();

                if (!data.success) {
                    throw new Error(data.error || 'Analysis failed');
                }

                const aiInsight = data.analysis;

                // Display the insights with nice formatting
                analysisDiv.innerHTML = aiInsight.split('\n\n').map(paragraph =>
                    `<p style="margin-bottom: 15px;">${paragraph}</p>`
                ).join('');

                // Success feedback
                button.style.background = 'linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)';
                button.textContent = '‚úÖ Patterns Revealed!';

                // Scroll to insights
                insightsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

                // Reset button after 3 seconds
                setTimeout(() => {
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    button.textContent = '‚ú® Help Me See Patterns with AI';
                }, 3000);

            } catch (error) {
                console.error('AI Analysis Error:', error);
                analysisDiv.innerHTML = `
                    <p style="color: #e74c3c; text-align: center;">
                        ‚ö†Ô∏è Unable to analyze patterns right now.<br>
                        Please try again in a moment, or complete "The Thread" section manually.
                    </p>
                `;
                button.disabled = false;
                button.style.opacity = '1';
                button.textContent = '‚ú® Help Me See Patterns with AI';
            }
        });

        // AI Unlock Moment Analysis with Claude
        document.getElementById('aiUnlockBtn').addEventListener('click', async function() {
            const button = this;
            const insightsDiv = document.getElementById('aiUnlockInsights');
            const analysisDiv = document.getElementById('aiUnlockAnalysis');

            // Get transformation data
            const beforeText = document.querySelector('.before-box textarea')?.value.trim() || '';
            const afterText = document.querySelector('.after-box textarea')?.value.trim() || '';
            const unlockMoment = document.getElementById('unlockMoment')?.value.trim() || '';

            // Check if enough data
            if (!beforeText || !afterText) {
                alert('üìù Please fill in both "Before" and "After" boxes in the Transformation Mirror section before requesting AI analysis.');
                return;
            }

            // Show loading state
            button.disabled = true;
            button.style.opacity = '0.7';
            button.textContent = 'üîÆ Revealing your pattern...';
            insightsDiv.style.display = 'block';
            analysisDiv.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">‚ú® Claude AI is analyzing your transformation pattern...</p>';

            try {
                // Prepare transformation data
                const transformationOutcomes = [
                    `Before: ${beforeText}`,
                    `After: ${afterText}`
                ];
                if (unlockMoment) {
                    transformationOutcomes.push(`Unlock Moment: ${unlockMoment}`);
                }

                // Call backend API
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        outcomes: transformationOutcomes,
                        type: 'unlock',
                        name: document.querySelector('input[placeholder*="optional"]')?.value || 'there'
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();

                if (!data.success) {
                    throw new Error(data.error || 'Analysis failed');
                }

                const aiInsight = data.analysis;

                // Display the insights with nice formatting
                analysisDiv.innerHTML = aiInsight.split('\n\n').map(paragraph =>
                    `<p style="margin-bottom: 15px;">${paragraph}</p>`
                ).join('');

                // Success feedback
                button.style.background = 'linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)';
                button.textContent = 'üîì Unlock Pattern Revealed!';

                // Scroll to insights
                insightsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

                // Reset button after 3 seconds
                setTimeout(() => {
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.background = 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)';
                    button.textContent = 'üîì Reveal My Unlock Pattern with AI';
                }, 3000);

            } catch (error) {
                console.error('AI Analysis Error:', error);
                analysisDiv.innerHTML = `
                    <p style="color: #e74c3c; text-align: center;">
                        ‚ö†Ô∏è Unable to analyze unlock pattern right now.<br>
                        Please try again in a moment, or complete "The Unlock Moment" section manually.
                    </p>
                `;
                button.disabled = false;
                button.style.opacity = '1';
                button.textContent = 'üîì Reveal My Unlock Pattern with AI';
            }
        });

        // Pattern Detection System - Find Common Threads
        function checkOutcomesComplete() {
            const outcomes = [];
            // Get all evidence boxes with "Outcome #" headings
            const evidenceBoxes = document.querySelectorAll('.evidence-box');

            evidenceBoxes.forEach(box => {
                const heading = box.querySelector('h3');
                if (heading && heading.textContent.includes('Outcome #')) {
                    const textarea = box.querySelector('textarea');
                    if (textarea && textarea.value.trim().length > 10) {
                        outcomes.push(textarea.value.trim());
                    }
                }
            });

            const findThreadBtn = document.getElementById('findThreadBtn');
            const threadPrompt = document.getElementById('threadPrompt');

            // Only update if elements exist
            if (findThreadBtn && threadPrompt) {
                if (outcomes.length >= 3) {
                    findThreadBtn.style.display = 'inline-block';
                    threadPrompt.textContent = `${outcomes.length} outcomes ready to analyse`;
                } else {
                    findThreadBtn.style.display = 'none';
                    threadPrompt.textContent = 'Complete at least 3 outcomes to discover your pattern';
                }
            }

            return outcomes;
        }

        // Monitor outcome textareas
        document.querySelectorAll('.evidence-box textarea').forEach((textarea, index) => {
            textarea.addEventListener('input', checkOutcomesComplete);
            textarea.addEventListener('blur', checkOutcomesComplete);
        });

        // Initial check on page load
        setTimeout(checkOutcomesComplete, 500);

        // Intelligent Pattern Analysis
        function findMyThread() {
            const outcomes = checkOutcomesComplete();

            if (outcomes.length < 3) {
                alert('Please complete at least 3 outcomes to detect patterns.');
                return;
            }

            const button = document.getElementById('findThreadBtn');
            button.textContent = 'Analysing patterns...';
            button.disabled = true;

            // Combine all outcomes
            const combinedText = outcomes.join(' ').toLowerCase();

            // Extract patterns
            const patterns = analysePatterns(outcomes);

            // Display results
            displayThreadResults(patterns);

            // Reset button
            setTimeout(() => {
                button.textContent = 'Find My Thread';
                button.disabled = false;
            }, 1000);
        }

        function analysePatterns(outcomes) {
            const patterns = {
                abilities: [],
                themes: [],
                verbs: [],
                impact: []
            };

            // Ability keywords
            const abilityKeywords = [
                'see', 'seeing', 'spot', 'spotted', 'notice', 'noticed', 'understand', 'understanding',
                'know', 'knowing', 'sense', 'sensed', 'feel', 'feeling', 'recognise', 'recognised',
                'identify', 'identified', 'detect', 'detected', 'perceive', 'perceived', 'realise', 'realised',
                'connect', 'connecting', 'link', 'linking', 'pattern', 'patterns'
            ];

            // Transformation keywords
            const transformKeywords = [
                'transform', 'transformed', 'change', 'changed', 'shift', 'shifted', 'help', 'helped',
                'enable', 'enabled', 'support', 'supported', 'guide', 'guided', 'unlock', 'unlocked',
                'clarity', 'clear', 'breakthrough', 'insight', 'realisation', 'understanding'
            ];

            // Action verbs that indicate what you DO
            const actionVerbs = [
                'ask', 'asked', 'question', 'questioned', 'explore', 'explored', 'dig', 'digging',
                'listen', 'listened', 'observe', 'observed', 'analyse', 'analysed', 'simplify', 'simplified',
                'organise', 'organised', 'structure', 'structured', 'create', 'created', 'build', 'built',
                'design', 'designed', 'solve', 'solved', 'fix', 'fixed'
            ];

            // Analyse each outcome
            outcomes.forEach(outcome => {
                const words = outcome.toLowerCase().split(/\s+/);

                // Find ability indicators
                abilityKeywords.forEach(keyword => {
                    if (outcome.toLowerCase().includes(keyword)) {
                        patterns.abilities.push(keyword);
                    }
                });

                // Find transformation indicators
                transformKeywords.forEach(keyword => {
                    if (outcome.toLowerCase().includes(keyword)) {
                        patterns.impact.push(keyword);
                    }
                });

                // Find action verbs
                actionVerbs.forEach(verb => {
                    if (outcome.toLowerCase().includes(verb)) {
                        patterns.verbs.push(verb);
                    }
                });
            });

            // Extract common phrases (2-3 words)
            const allText = outcomes.join(' ').toLowerCase();
            patterns.themes = extractCommonPhrases(allText);

            // Remove duplicates and count frequency
            patterns.abilities = countFrequency(patterns.abilities);
            patterns.impact = countFrequency(patterns.impact);
            patterns.verbs = countFrequency(patterns.verbs);

            return patterns;
        }

        function extractCommonPhrases(text) {
            const words = text.split(/\s+/).filter(w => w.length > 3);
            const phrases = {};

            // Look for 2-word phrases
            for (let i = 0; i < words.length - 1; i++) {
                const phrase = `${words[i]} ${words[i + 1]}`;
                // Skip common words
                if (!isCommonWord(words[i]) && !isCommonWord(words[i + 1])) {
                    phrases[phrase] = (phrases[phrase] || 0) + 1;
                }
            }

            // Return phrases that appear more than once
            return Object.entries(phrases)
                .filter(([phrase, count]) => count > 1)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .map(([phrase]) => phrase);
        }

        function isCommonWord(word) {
            const common = ['that', 'this', 'with', 'from', 'they', 'were', 'been', 'have',
                          'their', 'what', 'when', 'where', 'which', 'about', 'could',
                          'would', 'should', 'there', 'these', 'those'];
            return common.includes(word);
        }

        function countFrequency(array) {
            const frequency = {};
            array.forEach(item => {
                frequency[item] = (frequency[item] || 0) + 1;
            });

            return Object.entries(frequency)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .map(([word, count]) => ({ word, count }));
        }

        function displayThreadResults(patterns) {
            const resultsDiv = document.getElementById('threadResults');
            const patternsDiv = document.getElementById('detectedPatterns');

            let html = '';

            // Top ability
            if (patterns.abilities.length > 0) {
                const topAbility = patterns.abilities[0];
                html += `<div style="margin-bottom: 15px;">
                    <strong style="color: #e74c3c; font-size: 1.1em;">üéØ Your Core Ability:</strong><br>
                    <span style="font-size: 1.2em; font-style: italic;">
                        You have a gift for <strong>"${topAbility.word}"</strong>
                    </span>
                    <span style="color: #7f8c8d; font-size: 0.9em;"> (appeared ${topAbility.count} times)</span>
                </div>`;
            }

            // Top actions
            if (patterns.verbs.length > 0) {
                html += `<div style="margin-bottom: 15px;">
                    <strong style="color: #3498db;">üí™ What You Do:</strong><br>
                    <ul style="margin: 10px 0; padding-left: 20px;">`;
                patterns.verbs.slice(0, 3).forEach(verb => {
                    html += `<li>You <strong>${verb.word}</strong> naturally</li>`;
                });
                html += `</ul></div>`;
            }

            // Impact
            if (patterns.impact.length > 0) {
                html += `<div style="margin-bottom: 15px;">
                    <strong style="color: #27ae60;">‚ú® Your Impact:</strong><br>
                    <span>You consistently create <strong>"${patterns.impact[0].word}"</strong> for others</span>
                </div>`;
            }

            // Common themes
            if (patterns.themes.length > 0) {
                html += `<div style="margin-bottom: 15px;">
                    <strong style="color: #9b59b6;">üîç Recurring Themes:</strong><br>
                    <ul style="margin: 10px 0; padding-left: 20px; list-style: none;">`;
                patterns.themes.forEach(theme => {
                    html += `<li style="padding: 5px 0;">‚ñ∏ ${theme}</li>`;
                });
                html += `</ul></div>`;
            }

            // Summary insight
            html += `<div style="
                background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
                color: white;
                padding: 15px;
                border-radius: 10px;
                margin-top: 20px;
                font-style: italic;
            ">
                <strong>üí° The Pattern:</strong><br>
                ${generateInsight(patterns)}
            </div>`;

            patternsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';

            // Smooth scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function generateInsight(patterns) {
            const ability = patterns.abilities[0]?.word || 'perceiving patterns';
            const action = patterns.verbs[0]?.word || 'working';
            const impact = patterns.impact[0]?.word || 'transformation';

            const insights = [
                `You excel at <strong>${ability}</strong> what others miss. Through ${action}, you create ${impact} consistently.`,
                `Your superpower is <strong>${ability}</strong>. You naturally ${action}, which enables ${impact} in others.`,
                `Time after time, you <strong>${action}</strong> in ways that reveal what's hidden. Your gift for ${ability} creates real ${impact}.`,
                `The thread running through all your work: your ability to <strong>${ability}</strong> combined with how you ${action} creates consistent ${impact}.`
            ];

            // Return a random insight
            return insights[Math.floor(Math.random() * insights.length)];
        }

        // Progress Tracking System
        function updateProgress() {
            const sections = document.querySelectorAll('[data-section-number]');
            let completedCount = 0;

            sections.forEach((section, index) => {
                const textareas = section.querySelectorAll('textarea');
                const inputs = section.querySelectorAll('input[type="text"]');

                let sectionComplete = false;

                // Check if any textarea in this section has content
                textareas.forEach(textarea => {
                    if (textarea.value.trim().length > 10) {
                        sectionComplete = true;
                    }
                });

                // Also check inputs for the summary section
                if (inputs.length > 0) {
                    let hasInput = false;
                    inputs.forEach(input => {
                        if (input.value.trim().length > 0) {
                            hasInput = true;
                        }
                    });
                    if (hasInput) sectionComplete = true;
                }

                // Update dot
                const dot = document.querySelector(`.progress-dot[data-section="${index + 1}"]`);
                if (dot) {
                    if (sectionComplete) {
                        dot.style.background = '#7c3aed';
                        dot.style.width = '16px';
                        dot.style.height = '16px';
                        completedCount++;
                    } else {
                        dot.style.background = '#cbd5e1';
                        dot.style.width = '12px';
                        dot.style.height = '12px';
                    }
                }

                // Update checkmark
                const checkmark = section.querySelector('.checkmark');
                if (checkmark) {
                    if (sectionComplete) {
                        checkmark.classList.add('visible');
                    } else {
                        checkmark.classList.remove('visible');
                    }
                }
            });

            // Update progress text
            const progressText = document.getElementById('progressText');
            if (progressText) {
                progressText.textContent = `${completedCount} of 5 sections completed`;
                if (completedCount === 5) {
                    progressText.innerHTML = 'üéâ All sections complete!';
                    progressText.style.color = '#7c3aed';
                    progressText.style.fontWeight = '600';
                }
            }
        }

        // Click dots to jump to sections
        document.querySelectorAll('.progress-dot').forEach(dot => {
            dot.addEventListener('click', function() {
                const sectionNum = this.getAttribute('data-section');
                const section = document.querySelector(`[data-section-number="${sectionNum}"]`);
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });

            // Hover effect
            dot.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.3)';
            });
            dot.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });

        // Track progress on input
        document.querySelectorAll('textarea, input').forEach(element => {
            element.addEventListener('input', updateProgress);
        });

        // Initial progress check
        setTimeout(updateProgress, 1000);


        // Character Counter for Textareas
        document.querySelectorAll('.evidence-box, .transform-box').forEach(box => {
            const textarea = box.querySelector('textarea');
            if (textarea) {
                // Create counter element
                const counter = document.createElement('div');
                counter.className = 'char-counter';
                counter.textContent = '0 characters';
                textarea.parentElement.appendChild(counter);

                // Update counter on input
                textarea.addEventListener('input', function() {
                    const count = this.value.length;
                    counter.textContent = `${count} character${count !== 1 ? 's' : ''}`;

                    if (count > 0) {
                        counter.classList.add('visible');
                    } else {
                        counter.classList.remove('visible');
                    }

                    // Add "good" class if substantial content
                    if (count > 100) {
                        counter.classList.add('good');
                        counter.textContent = `${count} characters - Great detail! ‚úì`;
                    } else {
                        counter.classList.remove('good');
                    }
                });

                // Initialize counter if there's saved content
                if (textarea.value.length > 0) {
                    textarea.dispatchEvent(new Event('input'));
                }
            }
        });

        // Button hover effects
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05)';
            });

            button.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });

        // Special hover for Find My Thread button
        const findThreadBtn = document.getElementById('findThreadBtn');
        if (findThreadBtn) {
            findThreadBtn.addEventListener('mouseenter', function() {
                this.style.background = 'rgba(255,255,255,0.5)';
                this.style.transform = 'scale(1.1)';
            });
            findThreadBtn.addEventListener('mouseleave', function() {
                this.style.background = 'rgba(255,255,255,0.3)';
                this.style.transform = 'scale(1)';
            });
        }
    </script>
</body>
</html>